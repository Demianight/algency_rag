# –ú–∏–Ω–∏-RAG-—Å–µ—Ä–≤–∏—Å

HTTP-—Å–µ—Ä–≤–∏—Å –Ω–∞ FastAPI –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è RAG (Retrieval-Augmented Generation) —Å–∏—Å—Ç–µ–º—ã. –°–µ—Ä–≤–∏—Å —É–º–µ–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã (PDF, Markdown, TXT), —Å–æ–∑–¥–∞–≤–∞—Ç—å –∏—Ö –≤–µ–∫—Ç–æ—Ä–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∏ –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üìÑ **–ó–∞–≥—Ä—É–∑–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ PDF, Markdown –∏ TXT —Ñ–∞–π–ª–æ–≤
- üîç **–í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ OpenAI embeddings –∏ Qdrant –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è
- ü§ñ **–£–º–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã**: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤ —Å –ø–æ–º–æ—â—å—é GPT-4o/4.1-mini
- üìö **–ò—Å—Ç–æ—á–Ω–∏–∫–∏**: –í–æ–∑–≤—Ä–∞—Ç —Å–ø–∏—Å–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã—Ö —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤-–∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
- üè∑Ô∏è **–¢–µ–≥–∏**: –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–µ–≥–æ–≤ –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º
- üóëÔ∏è **–£–¥–∞–ª–µ–Ω–∏–µ**: –£–¥–∞–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∏ –∏—Ö —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤

## API Endpoints

| –ú–µ—Ç–æ–¥    | URL                   | –û–ø–∏—Å–∞–Ω–∏–µ                                                |
| -------- | --------------------- | ------------------------------------------------------- |
| `POST`   | `/documents/ingest`   | –ó–∞–≥—Ä—É–∑–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞ (multipart: `file`, `tags`(opt))     |
| `POST`   | `/chat/ask`           | –ó–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å (JSON: `{"question": str, "top_k": int}`) |
| `GET`    | `/health`             | –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ—Ä–≤–∏—Å–∞                              |
| `DELETE` | `/documents/{doc_id}` | –£–¥–∞–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞                                      |

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

1. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:**

```bash
git clone <repository-url>
cd test
```

2. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**

```bash
uv sync
```

3. **–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª .env:**

```bash
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env —Å –≤–∞—à–∏–º–∏ API –∫–ª—é—á–∞–º–∏
```

4. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ Qdrant:**

```bash
docker-compose up qdrant -d
```

5. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:**

```bash
uv run main.py
```

### Docker —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

1. **–°–æ–∑–¥–∞–π—Ç–µ .env —Ñ–∞–π–ª —Å –≤–∞—à–∏–º–∏ API –∫–ª—é—á–∞–º–∏**

2. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤–µ—Å—å —Å—Ç–µ–∫:**

```bash
docker-compose up --build
```

–°–µ—Ä–≤–∏—Å –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: http://localhost:8000

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### 1. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞

```bash
curl -X POST "http://localhost:8000/documents/ingest" \
  -H "Content-Type: multipart/form-data" \
  -F "file=@document.pdf" \
  -F "tags=research,important"
```

**–û—Ç–≤–µ—Ç:**

```json
{
  "document_id": "abc123def456",
  "status": "ingested"
}
```

### 2. –ó–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å

```bash
curl -X POST "http://localhost:8000/chat/ask" \
  -H "Content-Type: application/json" \
  -d '{
    "question": "–ß—Ç–æ —Ç–∞–∫–æ–µ –º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ?",
    "top_k": 3
  }'
```

**–û—Ç–≤–µ—Ç:**

```json
{
  "result": "–ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ - —ç—Ç–æ –ø–æ–¥—Ä–∞–∑–¥–µ–ª –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞...",
  "source_documents": [
    {
      "id": "chunk_123",
      "document_id": "abc123def456",
      "text": "–ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π..."
    }
  ]
}
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–∏—Å–∞

```bash
curl http://localhost:8000/health
```

**–û—Ç–≤–µ—Ç:**

```json
{
  "status": "alive"
}
```

### 4. –£–¥–∞–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞

```bash
curl -X DELETE "http://localhost:8000/documents/abc123def456"
```

**–û—Ç–≤–µ—Ç:**

```json
{
  "document_id": "abc123def456",
  "status": "deleted"
}
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç—ã —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º:

```bash
pytest --cov=src --cov-report=term-missing
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
src/
‚îú‚îÄ‚îÄ chat/           # API –¥–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤
‚îú‚îÄ‚îÄ documents/      # API –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
‚îú‚îÄ‚îÄ llm/           # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å LLM –∏ –≤–µ–∫—Ç–æ—Ä–Ω—ã–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º
‚îî‚îÄ‚îÄ settings.py    # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **FastAPI** - –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- **OpenAI** - LLM –∏ embeddings
- **Qdrant** - –≤–µ–∫—Ç–æ—Ä–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
- **LlamaParse** - –ø–∞—Ä—Å–∏–Ω–≥ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- **Pydantic** - –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- **Docker** - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è

## AI-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

–ü—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ —ç—Ç–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å —Å–ª–µ–¥—É—é—â–∏–µ AI-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:

- **Cursor** - –æ—Å–Ω–æ–≤–Ω–æ–π (—Å–æ –≤—Ç–æ—Ä–æ–≥–æ –¥–Ω—è) IDE —Å AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–æ–º –¥–ª—è –Ω–∞–ø–∏—Å–∞–Ω–∏—è –∫–æ–¥–∞, —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –æ—Ç–ª–∞–¥–∫–∏
- **ChatGPT** - –ø–æ–º–æ—â—å —Å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–º–∏ —Ä–µ—à–µ–Ω–∏—è–º–∏ –∏ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–π
- **GitHub Copilot** - –∞–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–¥–∞ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
